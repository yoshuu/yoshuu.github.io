<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>JS之路 Day03 - Prototype Chain(原型鏈) | Vic blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="昨天Prototype世界的例子中，小白這種打電話讓別人再去打電話找的方式，其實就是一種Prototype Chain的概念。">
<meta property="og:type" content="article">
<meta property="og:title" content="JS之路 Day03 - Prototype Chain(原型鏈)">
<meta property="og:url" content="https://yoshuu.github.io/2022/09/18/JS03/index.html">
<meta property="og:site_name" content="Vic blog">
<meta property="og:description" content="昨天Prototype世界的例子中，小白這種打電話讓別人再去打電話找的方式，其實就是一種Prototype Chain的概念。">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://i.imgur.com/eFnHLqm.png">
<meta property="og:image" content="https://i.imgur.com/52aTKfw.png">
<meta property="og:image" content="https://i.imgur.com/UAd8nXO.png">
<meta property="article:published_time" content="2022-09-18T12:36:34.000Z">
<meta property="article:modified_time" content="2023-04-24T12:37:45.684Z">
<meta property="article:author" content="可以點選上方“Vic blog”回到首頁～">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/eFnHLqm.png">
  
    <link rel="alternate" href="/atom.xml" title="Vic blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Vic blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜尋"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜尋"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://yoshuu.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-JS03" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/18/JS03/" class="article-date">
  <time class="dt-published" datetime="2022-09-18T12:36:34.000Z" itemprop="datePublished">2022-09-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/2022-iThome-%E9%90%B5%E4%BA%BA%E8%B3%BD/">2022 iThome 鐵人賽</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      JS之路 Day03 - Prototype Chain(原型鏈)
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>昨天<code>Prototype</code>世界的例子中，小白這種打電話讓別人再去打電話找的方式，其實就是一種<code>Prototype Chain</code>的概念。</p>
<span id="more"></span>

<p>畫一張示意圖會比較清楚一些，用一個空的陣列來做舉例。</p>
<p><img src="https://i.imgur.com/eFnHLqm.png"></p>
<p>首先，陣列也是一種物件，空陣列代表裡面什麼都沒有，不過不代表不能從空陣列去獲取東西。</p>
<p>當我要從物件裡面找一個不存在的屬性，JavaScript就會直接從它的原型物件去找，要是它的原型物件沒有，就會再往上找它的原型物件，直到最上面，都沒有那就是找不到。</p>
<p>而這個最上面的原型物件就稱作叫<code>Object.prototype</code>。<br>真的就最上面了，再往上找就是<code>null</code>。</p>
<p>而這一個由下往最上尋找的過程，一層一層相依尋找，就是原型鏈。</p>
<h2 id="Object-create"><a href="#Object-create" class="headerlink" title="Object.create"></a>Object.create</h2><p>這個可以拿來創造出一個擁有原型物件的新空物件，裡面的參數就帶要被繼承的原型物件，比如說:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> food = &#123;</span><br><span class="line">  <span class="attr">eat</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> apple = <span class="title class_">Object</span>.<span class="title function_">create</span>(food);</span><br></pre></td></tr></table></figure>
<p>這個新被創造出來的物件其實原型物件就會自動綁定是food了，所以現在的apple也可以去看eat的這個屬性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(apple.<span class="property">eat</span>); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>除此之外，<code>Object.create</code>還有一個很厲害的地方，它可以藉由放第二個參數，直接為新的物件增加額外的屬性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> food = &#123;</span><br><span class="line">  <span class="attr">eat</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> apple = <span class="title class_">Object</span>.<span class="title function_">create</span>(food, &#123;</span><br><span class="line">  <span class="attr">red</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(apple.<span class="property">red</span>);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>


<h2 id="Object-getPrototypeOf"><a href="#Object-getPrototypeOf" class="headerlink" title="Object.getPrototypeOf()"></a>Object.getPrototypeOf()</h2><p>昨天只講到如何設定原型，其實還可以獲取原型，那就是使用<code>Object.getPrototypeOf()</code>，這個語法會回傳物件中的原型物件。</p>
<p>用上面的例子來舉例:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> food = &#123;</span><br><span class="line">  <span class="attr">eat</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> apple = <span class="title class_">Object</span>.<span class="title function_">create</span>(food);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(apple) === food);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>apple的原型物件就是food，所以答案是true，證明沒想錯。</p>
<p><code>__proto__</code>其實也能做到相同的事情，不過使用<code>__proto__</code>來進行設定或是獲取都是件不太好的事情(詳情請看昨天)，所以請記得，現在主流的設定跟獲取方式:</p>
<ul>
<li>Object.getPrototypeOf() &#x3D;&gt; 獲取</li>
<li>Object.setPrototypeOf() &#x3D;&gt; 設定</li>
</ul>
<p>但是<code>__proto__</code>真的就一無可取之處嗎?那倒也不是，有一個用法的情境是不會被反對的。</p>
<h2 id="proto-當作屬性時"><a href="#proto-當作屬性時" class="headerlink" title="__proto__當作屬性時"></a><code>__proto__</code>當作屬性時</h2><p><img src="https://i.imgur.com/52aTKfw.png"><br>圖片來源: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/proto">MDN</a></p>
<p>看起來MDN裡面比較偏向說，不要使用<code>. __proto__</code>的方式，但把<code>__proto__</code>當作屬性時算是一個還蠻OK的方式。</p>
<p>也有查到其他地方也有這種說法:</p>
<blockquote>
<p>The only usage of <strong>proto</strong>, that’s not frowned upon, is as a property when creating a new object: { <strong>proto</strong>: … }.<br>說法出處:<a target="_blank" rel="noopener" href="https://javascript.info/prototype-methods">https://javascript.info/prototype-methods</a></p>
</blockquote>
<p>讓我們來看看這方法是怎麼實作的吧。</p>
<p>創建一個新物件時，可以把<code>__proto__</code>當作是屬性，然後它的value直接設定成所想要的原型物件。</p>
<p>有一個重點是，<code>__proto__</code>的值必須是物件或是null，比如說值是字串就無法，其實蠻合理的，因為字串不能變成一個原型。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> food = &#123;</span><br><span class="line">  <span class="attr">eat</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> apple = &#123;</span><br><span class="line">  <span class="attr">color</span>: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">  <span class="attr">__proto__</span>: food,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> coconut = &#123;</span><br><span class="line">  <span class="attr">hardness</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">__proto__</span>: apple,</span><br><span class="line"><span class="comment">// 怕大家不知道所以講一下，coconut是椰子</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>在這邊有三個新創的物件，我利用<code>__proto__</code>當屬性設定的方式，讓這三個物件形成一個原型鏈，藉由把apple的<code>__proto__</code>設定成food，再把coconut的<code>__proto__</code>屬性設定成apple，這樣一來，理論上應該可以在coconut使用到food的屬性，我們來測試看看。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(coconut.<span class="property">eat</span>); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>看來結果沒有錯，確實已經藉由<code>__proto__</code>當屬性的方式，把這三個物件串個原型鏈。</p>
<h2 id="不要做的事情"><a href="#不要做的事情" class="headerlink" title="不要做的事情"></a>不要做的事情</h2><p>現在已經提到了<code>Object.setPrototypeOf</code>以及<code>obj.__proto__</code>都可以直接的去更改原型物件，影響整體的<code>Prototype Chain</code>，但這是一件好的事情嗎？</p>
<p>關於這點去研究後，發現有些文章會說這個行為其實不是一件很好的事情，如下：<br><img src="https://i.imgur.com/UAd8nXO.png"><br>圖片來源：<a target="_blank" rel="noopener" href="https://javascript.info/prototype-methods">https://javascript.info/prototype-methods</a></p>
<p>大意就是，如果你今天覺得，速度很重要，就不要去修改已經存在的原型了，昨天有提到說，物件只能指定一種原型物件，要是去修改它，就會去覆蓋掉原本的原型物件，而這種行為，照那篇文章說，會去破壞掉<code>object property access operations</code>的內部優化，簡單說就會會讓<code>javascript</code>的執行速度變得很慢。</p>
<p>除非修改的重要程度比運行的速度還要重要，不然通常在創建物件時，就只會設置那麼一次，就不會再修改了，確實設計上是想改就改，但是除非有很確定自己在做什麼，不然我的理解是避免去做這件事情。</p>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p>可能其它程式語言並不是如此，但在<code>javascript</code>中就是透過<code>Prototype Chain</code>來把上下關係給連接起來，藉此來達到繼承的方式，推薦大家可以去看huli的 <a target="_blank" rel="noopener" href="https://blog.huli.tw/2017/08/27/the-javascripts-prototype-chain/">該來理解 JavaScript 的原型鍊了</a>，裡面講的很清楚好懂，那麼今天就是這些，我們明天見！</p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p>[1] <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf">Object.getPrototypeOf()</a><br>[2] <a target="_blank" rel="noopener" href="https://javascript.info/native-prototypes">Native prototypes</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yoshuu.github.io/2022/09/18/JS03/" data-id="clgutruvx0009di953yg4h0r2" data-title="JS之路 Day03 - Prototype Chain(原型鏈)" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/09/19/JS04/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          JS之路 Day04 - Prototypal Inheritance(原型繼承)
        
      </div>
    </a>
  
  
    <a href="/2022/09/17/JS02/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">JS之路 Day02 - Prototype (原型)</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分類</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/2022-iThome-%E9%90%B5%E4%BA%BA%E8%B3%BD/">2022 iThome 鐵人賽</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/html/">html</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/sass/">sass</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B4%BB%E5%8B%95%E5%BF%83%E5%BE%97/">活動心得</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%88%8A%E9%83%A8%E8%90%BD%E6%A0%BC%E7%A7%BB%E6%A4%8D%E6%96%87%E7%AB%A0/">舊部落格移植文章</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%82%84%E6%B2%92%E5%88%86%E9%A1%9E%E7%9A%84/">還沒分類的</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">標籤</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grid/" rel="tag">grid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sass/" rel="tag">sass</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">標籤雲</h3>
    <div class="widget tagcloud">
      <a href="/tags/css/" style="font-size: 20px;">css</a> <a href="/tags/grid/" style="font-size: 10px;">grid</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/sass/" style="font-size: 10px;">sass</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">彙整</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/02/28/volta/">volta 使用筆記</a>
          </li>
        
          <li>
            <a href="/2022/11/29/nodeJS%20readline/">node.js 取得使用者輸入</a>
          </li>
        
          <li>
            <a href="/2022/11/28/web%20client%20challenge/">好想工作室的案主挑戰賽 參加心得</a>
          </li>
        
          <li>
            <a href="/2022/11/27/sass%20build%20environment/">建立sass環境(2022)</a>
          </li>
        
          <li>
            <a href="/2022/11/13/snippets/">如何在vscode設定自己想要的使用者片段</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 可以點選上方“Vic blog”回到首頁～<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":350,"height":350},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>